<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TennisVerso | In√≠cio</title>
  <link rel="stylesheet" href="./css/style.css" />
  <link rel="stylesheet" href="./css/tenisdle.css" />

  <!-- Roboto -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap"
    rel="stylesheet" />

  <!-- Montserrat -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap"
    rel="stylesheet" />
</head>

<body>
  <header>
    <a href="./index.html"><img src="./assets/icon/raquete.png" alt="Logo" />TenisVerso</a>

    <nav>
      <ul>
        <li><a href="./index.html">In√≠cio</a></li>
        <li><a href="./artigos.html">Artigos</a></li>
        <li><a href="./tenisdle.html">Adivinhe o tenista</a></li>
        <li><a href="./login.html">Entrar</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <div class="container">
      <h1>Quem √© o tenista?</h1>
      <p>Digite o nome de um dos tenistas e tente adivinhar!</p>
      <p>Tentativas: <span id="span_tentativas"></span></p>

      <div class="inputs">
        <input type="text" id="input_tentativa" placeholder="Ex: Jo√£o Fonseca" />
        <button onclick="tentar()">Adivinhar</button>
      </div>

      <table id="tabelaTentativas">
        <thead id="thead">
          <tr>
            <th>Nome</th>
            <th>Idade</th>
            <th>Nacionalidade</th>
            <th>G√™nero</th>
            <th>Grand Slams</th>
          </tr>
        </thead>
        <tbody id="tentativas"></tbody>
      </table>

      <div id="mensagemFinal">
        üéâ Parab√©ns, voc√™ ganhou!
        <p>Pontua√ß√£o: <span id="span_pontuacao"></span></p>
      </div>

      <button onclick="reiniciar()" id="reiniciar">Tente novamente</button>
    </div>
  </main>
</body>

</html>

<script>
  // array com os tenistas poss√≠veis
  const tenistas = [
    ["Rafael Nadal", 37, "Espanhol", "Masculino", 22],
    ["Roger Federer", 42, "Su√≠√ßo", "Masculino", 20],
    ["Novak Djokovic", 36, "S√©rvio", "Masculino", 24],
    ["Serena Williams", 41, "Americana", "Feminino", 23],
    ["Carlos Alcaraz", 21, "Espanhol", "Masculino", 2],
  ];

  var pontuacao = 0;
  var chances = 5
  span_tentativas.innerHTML = chances

  // escolhendo um tenista aleat√≥rio
  let alvo = tenistas[Math.floor(Math.random() * tenistas.length)];

  let arrayTentativas = [];
  let tbody = document.getElementById("tentativas");

  // objeto para armazenar os acertos
  let acertos = {
    nome: false,
    idade: false,
    nacionalidade: false,
    genero: false,
    grandSlams: false,
  };

  // fun√ß√£o para resetar o jogo e come√ßar dnv
  function reiniciar() {
    mensagemFinal.innerHTML = "";
    tbody.innerHTML = "";
    arrayTentativas = [];
    pontuacao = 0;
    chances = 5;
    span_tentativas.innerHTML = chances
    alvo = tenistas[Math.floor(Math.random() * tenistas.length)];
    acertos = {
      nome: false,
      idade: false,
      nacionalidade: false,
      genero: false,
      grandSlams: false,
    };
    var mensagem = document.getElementById("mensagemFinal");
    mensagem.style.display = "none";
    
    var botaoResetar = document.getElementById("reiniciar");
    botaoResetar.style.display = "none";
  }

  // fun√ß√£o de tentativa
  function tentar() {
    let tentativa = input_tentativa.value.trim(); //.trim remove espa√ßos
    let tentativas = "";
    let validacaoExisteTenista = false;

    // verificando se o tenista existe
    for (let i = 0; i < tenistas.length; i++) {
      if (tentativa.toLowerCase() == tenistas[i][0].toLowerCase()) {
        validacaoExisteTenista = true;
        indexTenista = i;
        break;
      }
    }

    if (validacaoExisteTenista) {
      let nome = tenistas[indexTenista][0];
      let idade = tenistas[indexTenista][1];
      let nacionalidade = tenistas[indexTenista][2];
      let genero = tenistas[indexTenista][3];
      let torneio = tenistas[indexTenista][4];

      // atualizando os acertos
      if (nome == alvo[0]) acertos.nome = true;
      if (idade == alvo[1]) acertos.idade = true;
      if (nacionalidade == alvo[2]) acertos.nacionalidade = true;
      if (genero == alvo[3]) acertos.genero = true;
      if (torneio == alvo[4]) acertos.grandSlams = true;

      // diminuindo as tentativas
      chances--
      span_tentativas.innerHTML = chances

      if (
        acertos.nome &&
        acertos.idade &&
        acertos.nacionalidade &&
        acertos.genero &&
        acertos.grandSlams
      ) {
        var mensagem = document.getElementById("mensagemFinal");
        mensagem.style.display = "block";

        var botaoResetar = document.getElementById("reiniciar");
        botaoResetar.style.display = "block";

        // sistema de pontua√ß√£o
        if (chances == 4) {
          pontuacao = chances * 1250
          span_pontuacao.innerHTML = pontuacao
        }else if(chances == 3){
          pontuacao = chances * 1000
          span_pontuacao.innerHTML = pontuacao
        }else if(chances == 2){
          pontuacao = chances * 750
          span_pontuacao.innerHTML = pontuacao
        }else if(chances == 1){
          pontuacao = chances * 500
          span_pontuacao.innerHTML = pontuacao
        }else{
          pontuacao = chances * 250
          span_pontuacao.innerHTML = pontuacao
        }
      }

      // adicionando a tentativa numa array
      if (
        arrayTentativas.some((t) => t[0].toLowerCase() === nome.toLowerCase())
      ) {
        alert("Voc√™ j√° tentou esse tenista!");
        input_tentativa.value = "";
        return;
      }

      arrayTentativas.push([nome, idade, nacionalidade, genero, torneio]);

      // limpa tabela e reconstr√≥i com as tentativas ao contr√°rio, para a √∫ltima tentativa ficar no topo
      tbody.innerHTML = "";
      for (let i = arrayTentativas.length - 1; i >= 0; i--) {
        let tentativaAtual = arrayTentativas[i];

        tentativas += `
            <tr class="tentativa">
                <th class="ceulaNome ${acertos.nome && tentativaAtual[0] == alvo[0] ? "certa" : ""
          }">
                    ${tentativaAtual[0]}</th>
                <th class="ceulaIdade ${acertos.idade && tentativaAtual[1] == alvo[1] ? "certa" : ""
          }">
                    ${tentativaAtual[1]}</th>
                <th class="ceulaNacionalidade ${acertos.nacionalidade && tentativaAtual[2] == alvo[2]
            ? "certa"
            : ""
          }">${tentativaAtual[2]}</th>
                <th class="ceulagenero ${acertos.genero && tentativaAtual[3] == alvo[3] ? "certa" : ""
          }">
                    ${tentativaAtual[3]}</th>
                <th class="ceulaTorneio ${acertos.grandSlams && tentativaAtual[4] == alvo[4]
            ? "certa"
            : ""
          }">
                    ${tentativaAtual[4]}</th>
            </tr>`;

        input_tentativa.focus();
      }

      tbody.innerHTML = tentativas;
      input_tentativa.value = "";
    } else {
      alert("Tenista n√£o encontrado!");
      input_tentativa.value = "";
    }
  }

  // pressionar enter para fazer a tentativa
  input_tentativa.addEventListener("keydown", function (event) {
    if (event.key == "Enter") {
      tentar();
    }
  });
</script>